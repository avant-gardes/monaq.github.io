<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>MONAQ</title>
  <meta name="author" content="monica.kwon">

  
  <meta name="description" content="chrome dev summit 2017Building a Modern Media Experience (Chrome Dev Summit 2017) from Chrome Media Team
해당 포스트는 지난 chrome dev summit 2017 중 크롬브라우저에서의">
  
  

  <link rel="alternate" href="/atom.xml" title="MONAQ" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
  
</head>

<body>
  <header id="header" class="inner"><nav>
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
</nav></header>
  <div id="content" class="inner"><article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <header>
    
  
    <h1 class="title"></h1>
  

    <time datetime="2017-11-02T01:43:26.000Z">
  <span class="day">2</span><span class="month">Nov</span>
</time>
  </header>
  <div class="entry-content">
    
      <h1 id="chrome-dev-summit-2017"><a href="#chrome-dev-summit-2017" class="headerlink" title="chrome dev summit 2017"></a>chrome dev summit 2017</h1><h2 id="Building-a-Modern-Media-Experience-Chrome-Dev-Summit-2017-from-Chrome-Media-Team"><a href="#Building-a-Modern-Media-Experience-Chrome-Dev-Summit-2017-from-Chrome-Media-Team" class="headerlink" title="Building a Modern Media Experience (Chrome Dev Summit 2017) from Chrome Media Team"></a>Building a Modern Media Experience (Chrome Dev Summit 2017) from Chrome Media Team</h2><ul>
<li>해당 포스트는 지난 chrome dev summit 2017 중 크롬브라우저에서의 미디어 재생에 관한 내용을 러프하게 옮긴 것입니다. 지적 참견 환영합니다</li>
</ul>
<p><a href="https://youtu.be/WRSEJCKu7zA" target="_blank" rel="external"><img src="" alt="Building a Modern Media Experience"></a></p>
<h3 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h3><p>미디어 전달의 중요성이 점차 높아지고 있음:</p>
<ul>
<li>Forbes, iHeartRadio, Geo Cinema 등의 사이트에서 동영상을 주요하게 활용중</li>
<li>모바일 웹 미디어의 시청 시간 증가<br>: 지난 6개월간 크롬 안드로이드에서 사용자별 미디어 재생 시간이 2배 증가함</li>
</ul>
<h3 id="목차"><a href="#목차" class="headerlink" title="목차"></a>목차</h3><ul>
<li>미디어 관련 크롬 업데이트 사항</li>
<li>조금 더 발전된 미디어 적용 사례</li>
<li>PWA(<a href="http://terms.naver.com/entry.nhn?docId=3581225&amp;cid=59088&amp;categoryId=59096" target="_blank" rel="external">참고</a>) 활용 사례와 offline 미디어 재생사례 소개</li>
</ul>
<h4 id="1-크롬-업데이트-사항"><a href="#1-크롬-업데이트-사항" class="headerlink" title="1. 크롬 업데이트 사항"></a>1. 크롬 업데이트 사항</h4><ul>
<li>오토플레이</li>
</ul>
<p>문제점 1. 오디오재생이 사용자의 의지와 상관없이 일어나는 것은 가장 많은 불만 사례이다.</p>
<p>문제점 2. 데스크탑과 모바일간에 오토플레이 정책이 일관적이지 않음</p>
<p>-&gt; 바뀐 정책:</p>
<p>모든 플랫폼에서(iframe포함) 음소거된 미디어 자동재생만이 허용됨</p>
<p>세 가지 경우만 빼고</p>
<ul>
<li>사용자 액션이 있을때: 미디어 탭 또는 클릭, 동영상 페이지로 이동</li>
<li>데스크탑에서 사용자가 오디오를 많이 사용할 때</li>
<li>모바일 환경에서 사이트가 홈화면에 추가되었을 때</li>
</ul>
<p>-promise로 사용자 환경에서의 음소거 자동재생 허용여부 확인 가능<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">var promise = document.querySelector(&apos;video&apos;).play()</div><div class="line">  if (promise !== undefined) &#123;</div><div class="line">    promise.then(_ =&gt; &#123;</div><div class="line">    // 오토플레이 스타트</div><div class="line">      </div><div class="line">    &#125;).catch(error =&gt; &#123;</div><div class="line">      // 오토플레이가 허용되지 않음</div><div class="line">      // 풀래아버튼이 노출되고, 사용자가 클릭하면 재생</div><div class="line">    &#125;)</div><div class="line">  &#125;</div></pre></td></tr></table></figure></p>
<p>-iframe 내부의 미디어 경우 앞으로 attribute를 통해 액세스 권한을 부여할 수 있음<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;iframe src=&quot;myvideo.html&quot; gesture=media&gt;</div></pre></td></tr></table></figure></p>
<p>-web btt 및 ttml의 렌더링을 사용자 정의할 수 있음</p>
<p>-오프라인으로 보호되는 미디어재생이 허용</p>
<h4 id="2-더-나은-미디어-적용-사례"><a href="#2-더-나은-미디어-적용-사례" class="headerlink" title="2. 더 나은 미디어 적용 사례"></a>2. 더 나은 미디어 적용 사례</h4><p>-2초간 버퍼링이 있을 때 초당 약 6%가 재생하지 않음</p>
<ul>
<li>preload를 통해 미디어 재생을 빨리 처리할 수 있음</li>
</ul>
<ul>
<li>preload를 auto로 하면 인앱 데이터가 캐싱되고 버퍼링 중지 없이 전체 재생이 가능..<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&lt;video id=&quot;video&quot; preload=&quot;auto&quot; src=&quot;file.mp4&quot; controls&gt;&lt;/video&gt;</div><div class="line"></div><div class="line">&lt;script&gt;</div><div class="line">     video.addEventListener(&apos;loadedmetadata&apos;, function () &#123;</div><div class="line">          var bufferedSeconds = video.buffered.end(0) - video.buffered.start(0)</div><div class="line">          console.log(bufferedSeconds + &apos; seconds of video are ready to play&apos;)</div><div class="line">        &#125;)</div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>하지만 브라우저가 이를 무시할 수 있다(ex.데이터 세이버 사용)</p>
<ul>
<li>link preload는 페이지가 다운로드 중일 때 윈도우 로드를 직접 차단하지 않고 브라우저가 자원에 대한 요청을 하도록 하는 기능임. </li>
</ul>
<p>–link preload된 리소스는 브라우저에 로컬로 저장되며 DOM, javascript나 css 에서 사용될 때까지 비활성화됨</p>
<ul>
<li>MSC API를 활용한 예제</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&lt;link rel=&quot;preload&quot; as=&quot;fetch&quot; href=&quot;https://cdn.com/file.webm&quot;&gt;</div><div class="line">&lt;video id=&quot;video&quot; controls&gt;&lt;/video&gt;</div><div class="line"></div><div class="line">&lt;script&gt;</div><div class="line">    const mediaSource = new MediaSource()</div><div class="line">    video.src = URL.createObjectURL(mediaSource)</div><div class="line">    mediaSource.addEventListener(&apos;sourceopen&apos;, async function() &#123;</div><div class="line">      const sourceBuffer = mediaSource.addSourceBuffer(&apos;video/webm; codecs=vp9&apos;)</div><div class="line">      const res = await fetch(&apos;https://cdn.com/file.webm&apos;)</div><div class="line">      const data = await res.arrayBuffer()</div><div class="line">      sourceBuffer.appendBuffer(data)</div><div class="line">    &#125;)</div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure>
<p>-디바이스 메모리가 1기가 미만인 경우 사용자가 저성능 장치에 있다고 가정함(http 헤더 체크)<br>사용자가 데이터 요금을 지불해야 할 수 있음을 명심</p>
<p>미디어 세션 api사용: 브라우저에서 이를 지원하는 경우 제목, 아티스트 같은 메타 데이터를 제공 가능</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">// 미디어가 재생될 때</div><div class="line"></div><div class="line">if (&apos;mediaSession&apos; in navigator ) &#123;</div><div class="line">  navigator.mediaSession.metadata = new MediaMetadata(&#123;</div><div class="line">    title: &apos;Never Gonna Give You Up&apos;,</div><div class="line">    artist: &apos;Rick Astley&apos;,</div><div class="line">    album: &apos;Whenever You Need Somebody&apos;,</div><div class="line">    artwork: [</div><div class="line">      &#123; src: &apos;https://..&apos;, sizes: &apos;256x256&apos;, type: &apos;image/png&apos; &#125;,</div><div class="line">      &#123; src: &apos;https://..&apos;, sizes: &apos;256x256&apos;, type: &apos;image/png&apos; &#125;</div><div class="line">    ]</div><div class="line">  &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>비디오가 보이지 않을 때 비디오 재생 멈추기<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">// 미디어가 재생될 때</div><div class="line">document.addEventListener(&apos;visivilitychange&apos;, function () &#123;</div><div class="line">  if (document.visibilityState === &apos;hidden&apos;) &#123;</div><div class="line">    video.pause()</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>유용한 API들<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">// 미디어 액션 핸들러</div><div class="line">navigator.mediaSession.setActionHandler(&apos;seekbackward&apos;, evt =&gt; &#123; ... &#125;)</div><div class="line">navigator.mediaSession.setActionHandler(&apos;seekforward&apos;, evt =&gt; &#123; ... &#125;)</div><div class="line">navigator.mediaSession.setActionHandler(&apos;play&apos;, evt =&gt; &#123; ... &#125;)</div><div class="line">navigator.mediaSession.setActionHandler(&apos;pause&apos;, evt =&gt; &#123; ... &#125;)</div><div class="line">navigator.mediaSession.setActionHandler(&apos;nexttrack&apos;, evt =&gt; &#123; ... &#125;)</div><div class="line">navigator.mediaSession.setActionHandler(&apos;previoustrack&apos;, evt =&gt; &#123; ... &#125;)</div><div class="line"></div><div class="line">// UI를 알림 컨트롤과 동기화</div><div class="line">// 미디어가 로드되었으나 아직 플레이되지 않고 있을 때 유용한 코드</div><div class="line">navigator.mediaSession.playbackState = &apos;playing&apos;</div></pre></td></tr></table></figure></p>
<h4 id="3-voot-com-사례"><a href="#3-voot-com-사례" class="headerlink" title="3. voot.com 사례"></a>3. voot.com 사례</h4><p>-인도는 2천 6백만대가 저성능 디바이스를 사용</p>
<ul>
<li>인터넷이 될 때 다운로드해서 오프라인 모드에서 미디어를 재생할 수 있음</li>
<li>Index db를 삽입하여 다운로드한 리소스에 대한 기록을 남김<br>-&gt; 백그라운드를 불러온 리소스와 비교하여 현재 미디어를 확인 -&gt; 다운로드한 리소스를 캐시에 저장</li>
</ul>
<p>인도의 경우 데이터 환경이 안정적이지 않음<br>버스에서 vootGo에 로그인하여 wifi를 이용, 컨텐츠를 다운받을 수 있게 함</p>

    
    
    <footer class="meta">
      
      
      
    </footer>
    
  </div>
  
</article></div>
  <footer id="footer" class="inner"><div class="social alignright">
  
  
  
  
  <a class="rss" href="/atom.xml" title="RSS">RSS</a>
</div>
<p>
  
  &copy; 2017 monica.kwon
  
</p>
<div class="clearfix"></div></footer>
  <script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>


<div id="phasebeam">
  <canvas></canvas>
  <canvas></canvas>
  <canvas></canvas>
</div>
<script src="/js/phasebeam.js"></script>
</body>
</html>